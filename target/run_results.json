{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.0", "generated_at": "2024-05-27T22:12:26.884867Z", "invocation_id": "0f3fc59a-2aec-4005-879c-f9ebcd643a36", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-27T22:12:24.593615Z", "completed_at": "2024-05-27T22:12:24.617585Z"}, {"name": "execute", "started_at": "2024-05-27T22:12:24.656265Z", "completed_at": "2024-05-27T22:12:25.516703Z"}], "thread_id": "Thread-1", "execution_time": 1.1287448406219482, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b49df4-0305-3274-0006-0553000300aa"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform_w_dbt.stg_tpch__customers", "compiled": true, "compiled_code": "-- write staging model following best practices and coventions outlined in style guide\nSELECT \n    ROW_NUMBER() OVER (ORDER BY c_custkey) AS object_id,\n    c_custkey AS customer_key,\n    c_name AS customer_name,\n    c_address AS address,\n    c_nationkey AS nation_key,\n    c_phone AS phone,\n    c_acctbal AS account_balance,\n    c_mktsegment AS market_segment,\n    c_comment AS comment\nFROM snowflake_sample_data.tpch_sf1.customer\n-- be sure to also update any downstream dependencies", "relation_name": "dev.staging.stg_tpch__customers"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-27T22:12:24.649900Z", "completed_at": "2024-05-27T22:12:24.696592Z"}, {"name": "execute", "started_at": "2024-05-27T22:12:24.774274Z", "completed_at": "2024-05-27T22:12:25.518168Z"}], "thread_id": "Thread-4", "execution_time": 1.1204781532287598, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b49df4-0305-358d-0006-05530002c08e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform_w_dbt.stg_tpch__orders", "compiled": true, "compiled_code": "SELECT \n    o_orderkey AS order_key, \n    o_custkey AS customer_key, \n    o_orderstatus AS order_status_code, \n    o_totalprice AS total_price_usd, \n    o_orderdate::date AS order_date,\n    o_orderpriority AS order_priority, \n    o_clerk AS clerk, \n    o_shippriority AS ship_priority_code\nFROM snowflake_sample_data.tpch_sf1.orders", "relation_name": "dev.staging.stg_tpch__orders"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-27T22:12:24.610914Z", "completed_at": "2024-05-27T22:12:24.684169Z"}, {"name": "execute", "started_at": "2024-05-27T22:12:24.719063Z", "completed_at": "2024-05-27T22:12:25.522484Z"}], "thread_id": "Thread-2", "execution_time": 1.124295949935913, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b49df4-0305-311f-0006-0553000330ca"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform_w_dbt.stg_tpch__line_items", "compiled": true, "compiled_code": "SELECT \n    -- creates a unique key for line items \n    md5(cast(coalesce(cast(l_orderkey  as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS line_item_key, \n    l_orderkey AS order_key, \n    l_partkey AS part_key, \n    l_suppkey AS supplier_key, \n    l_linenumber AS line_number, \n    ROUND(l_quantity, 0) AS item_quantity, \n    l_extendedprice AS extended_price_usd,\n    l_discount AS discount_amount_usd, \n    l_tax AS tax_amount_usd, \n    l_returnflag AS return_flag_code, \n    l_linestatus AS line_status_code, \n    l_shipdate::date AS ship_date\nFROM snowflake_sample_data.tpch_sf1.lineitem", "relation_name": "dev.staging.stg_tpch__line_items"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-27T22:12:24.665818Z", "completed_at": "2024-05-27T22:12:24.787513Z"}, {"name": "execute", "started_at": "2024-05-27T22:12:24.788966Z", "completed_at": "2024-05-27T22:12:25.534805Z"}], "thread_id": "Thread-3", "execution_time": 1.1131372451782227, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b49df4-0305-3129-0006-05530002e08e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform_w_dbt.stg_tpch__nations", "compiled": true, "compiled_code": "-- write staging model following best practices and coventions outlined in style guide\nSELECT \n    ROW_NUMBER() OVER (ORDER BY n_nationkey) AS object_id,\n    n_nationkey AS nation_key,\n    n_name AS nation_name,\n    n_regionkey AS region_key,\n    n_comment AS comment\nFROM snowflake_sample_data.tpch_sf1.nation\n-- be sure to also update any downstream dependencies", "relation_name": "dev.staging.stg_tpch__nations"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-27T22:12:25.770747Z", "completed_at": "2024-05-27T22:12:25.801399Z"}, {"name": "execute", "started_at": "2024-05-27T22:12:25.810442Z", "completed_at": "2024-05-27T22:12:26.634654Z"}], "thread_id": "Thread-5", "execution_time": 1.0443320274353027, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b49df4-0305-323f-0006-05530002f0e2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform_w_dbt.order_line_items", "compiled": true, "compiled_code": "WITH \nline_items_returns_removed AS (\n    SELECT \n        line_item_key, \n        order_key, \n        part_key,\n        supplier_key, \n        line_number, \n        item_quantity, \n        extended_price_usd,\n        discount_amount_usd, \n        tax_amount_usd, \n        return_flag_code, \n        line_status_code, \n        ship_date\n    FROM dev.staging.stg_tpch__line_items \n    -- only select items that haven't been returned and have already been shipped \n    WHERE return_flag_code != 'R'\n    AND ship_date < CURRENT_DATE\n),\n\norders_joined_line_items AS (\n    SELECT \n        orders.order_key, \n        line_items.line_item_key, \n        orders.order_priority, \n        orders.order_status_code,\n        orders.total_price_usd, \n        line_items.item_quantity,\n        line_items.return_flag_code,\n        line_items.discount_amount_usd,\n        line_items.extended_price_usd\n    FROM dev.staging.stg_tpch__orders  orders\n    LEFT JOIN line_items_returns_removed line_items\n        ON orders.order_key = line_items.order_key\n),\n\nitem_quantity_summed AS (\n    SELECT \n        order_key, \n        line_item_key, \n        order_priority, \n        order_status_code, \n        return_flag_code, \n        extended_price_usd * (1 - discount_amount_usd) AS revenue, \n        item_quantity, \n        SUM(item_quantity) OVER(PARTITION BY order_key) AS total_order_items,\n        total_price_usd\n    FROM orders_joined_line_items\n)\n\nSELECT * FROM item_quantity_summed", "relation_name": "dev.staging.order_line_items"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-27T22:12:25.754078Z", "completed_at": "2024-05-27T22:12:25.790092Z"}, {"name": "execute", "started_at": "2024-05-27T22:12:25.793532Z", "completed_at": "2024-05-27T22:12:26.653525Z"}], "thread_id": "Thread-8", "execution_time": 1.0574429035186768, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b49df4-0305-3126-0006-0553000340c6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform_w_dbt.int_orders_w_no_returns", "compiled": true, "compiled_code": "WITH \norders_returns_removed AS (\n    SELECT \n        order_key\n    FROM dev.staging.stg_tpch__orders orders\n    -- only select orders that don't have items that have been returned\n    WHERE NOT EXISTS (\n        SELECT \n            1\n        FROM dev.staging.stg_tpch__line_items line_items \n        WHERE orders.order_key = line_items.order_key\n            AND return_flag_code = 'R'\n    )\n)\nSELECT * FROM orders_returns_removed", "relation_name": "dev.intermediate.int_orders_w_no_returns"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-27T22:12:25.738234Z", "completed_at": "2024-05-27T22:12:25.752062Z"}, {"name": "execute", "started_at": "2024-05-27T22:12:25.763700Z", "completed_at": "2024-05-27T22:12:26.676461Z"}], "thread_id": "Thread-6", "execution_time": 1.1031248569488525, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b49df4-0305-30fb-0006-05530002b0c6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform_w_dbt.hubspot_customers", "compiled": true, "compiled_code": "SELECT \n    customer_key, \n    customer_name, \n    address, \n    phone\nFROM dev.staging.stg_tpch__customers", "relation_name": "dev.staging.hubspot_customers"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-27T22:12:25.779399Z", "completed_at": "2024-05-27T22:12:25.798614Z"}, {"name": "execute", "started_at": "2024-05-27T22:12:25.802821Z", "completed_at": "2024-05-27T22:12:26.711036Z"}], "thread_id": "Thread-1", "execution_time": 1.1207261085510254, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b49df4-0305-3274-0006-0553000300ae"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.transform_w_dbt.returned_item_customers", "compiled": true, "compiled_code": "SELECT \n    customers.customer_key, \n    customers.customer_name, \n    SUM(line_items.extended_price_usd * (1 - line_items.discount_amount_usd)) AS revenue, \n    customers.account_balance, \n    nations.nation_name, \n    customers.address, \n    customers.phone\nFROM dev.staging.stg_tpch__customers customers \nLEFT JOIN dev.staging.stg_tpch__orders orders \n    ON customers.customer_key = orders.customer_key\nLEFT JOIN dev.staging.stg_tpch__line_items line_items \n    ON orders.order_key = line_items.order_key \nLEFT JOIN dev.staging.stg_tpch__nations nations \n    ON customers.nation_key = nations.nation_key \nWHERE orders.order_date < CURRENT_DATE\n    AND orders.order_date >= DATEADD(month, -3, CURRENT_DATE)\n    AND line_items.return_flag_code = 'R'\nGROUP BY\n    customers.customer_key,\n    customers.customer_name, \n    customers.account_balance, \n    nations.nation_name, \n    customers.address, \n    customers.phone", "relation_name": "dev.staging.returned_item_customers"}], "elapsed_time": 3.9369781017303467, "args": {"require_resource_names_without_spaces": false, "quiet": false, "log_format_file": "debug", "show_resource_report": false, "version_check": true, "log_path": "/Users/keenanburkepitts/transform_w_dbt/logs", "require_explicit_package_overrides_for_builtin_materializations": true, "vars": {}, "use_colors": true, "printer_width": 80, "use_colors_file": true, "log_file_max_bytes": 10485760, "partial_parse": true, "source_freshness_run_project_hooks": false, "write_json": true, "project_dir": "/Users/keenanburkepitts/transform_w_dbt", "favor_state": false, "warn_error_options": {"include": [], "exclude": []}, "cache_selected_only": false, "macro_debugging": false, "indirect_selection": "eager", "profiles_dir": "/Users/keenanburkepitts/.dbt", "which": "run", "log_level": "info", "invocation_command": "dbt run", "select": [], "static_parser": true, "exclude": [], "send_anonymous_usage_stats": true, "log_level_file": "debug", "introspect": true, "defer": false, "print": true, "partial_parse_file_diff": true, "enable_legacy_logger": false, "populate_cache": true, "strict_mode": false, "log_format": "default", "empty": false}}